{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/prueba despliegue/entrega3-web/front/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/User/Desktop/prueba despliegue/entrega3-web/front/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/User/Desktop/prueba despliegue/entrega3-web/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/User/Desktop/prueba despliegue/entrega3-web/front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import\"bootstrap/dist/css/bootstrap.min.css\";import'../styles/auth.css';import{useState}from\"react\";import{HashLink as Link}from'react-router-hash-link';import{useHistory}from\"react-router-dom\";import React from'react';var Register=function Register(props){var setUser=props.user;var _useState=useState({nombre:'',apellido:'',correo:'',extension:'+57 1',telefono:'',tipoUsuario:'',password:'',confirmationPassword:'',matchingPasswords:true,uniqueEmail:true}),_useState2=_slicedToArray(_useState,2),formInfo=_useState2[0],setFormInfo=_useState2[1];var history=useHistory();function onSubmit(_x){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var existence;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(formInfo.password!==formInfo.confirmationPassword)){_context.next=5;break;}// Warning message \nsetFormInfo(_objectSpread(_objectSpread({},formInfo),{matchingPasswords:false}));_context.next=11;break;case 5:setFormInfo(_objectSpread(_objectSpread({},formInfo),{matchingPasswords:true}));console.log('Seteado a True');_context.next=9;return verifyExistence(formInfo.correo);case 9:existence=_context.sent;if(existence){// Warning\nsetFormInfo(_objectSpread(_objectSpread({},formInfo),{uniqueEmail:false}));}else{// Login\nsetFormInfo(_objectSpread(_objectSpread({},formInfo),{uniqueEmail:true}));register();}case 11:case\"end\":return _context.stop();}}},_callee);}));return _onSubmit.apply(this,arguments);}function verifyExistence(_x2){return _verifyExistence.apply(this,arguments);}function _verifyExistence(){_verifyExistence=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(mail){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"/api/users/\".concat(mail));case 3:_context2.next=5;return _context2.sent.json();case 5:user=_context2.sent;return _context2.abrupt(\"return\",user.email?true:false);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",false);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return _verifyExistence.apply(this,arguments);}function register(){return _register.apply(this,arguments);}function _register(){_register=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var body,headers,user;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:body={nombre:formInfo.nombre,apellidos:formInfo.apellido,email:formInfo.correo,telefono:\"\".concat(formInfo.extension,\" \").concat(formInfo.telefono),fundacion:formInfo.tipoUsuario==='Fundación'?true:false,clave:formInfo.password};headers={'Content-Type':'application/json'};_context3.next=4;return fetch('/api/users',{method:'POST',headers:headers,body:JSON.stringify(body)});case 4:_context3.next=6;return _context3.sent.json();case 6:user=_context3.sent;localStorage.setItem('user',JSON.stringify(user));setUser(user);history.push('/');case 10:case\"end\":return _context3.stop();}}},_callee3);}));return _register.apply(this,arguments);}return/*#__PURE__*/_jsx(\"section\",{id:\"register\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card bg-light\",id:\"registerdiv\",children:/*#__PURE__*/_jsxs(\"article\",{className:\"card-body mx-auto\",style:{maxWidth:\"400px\"},children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title mt-3 text-center\",children:\"Crea tu cuenta\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"y empieza a donar!\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"form-registro\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-user\"})})}),/*#__PURE__*/_jsx(\"input\",{name:\"name\",className:\"form-control\",placeholder:\"Nombre\",value:formInfo.nombre,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{nombre:e.target.value}));},type:\"text\",required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"lastname\",className:\"form-control\",placeholder:\"Apellido\",value:formInfo.apellido,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{apellido:e.target.value}));},type:\"text\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-envelope\"})})}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",className:\"form-control\",placeholder:\"Correo Electr\\xF3nico\",value:formInfo.correo,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{correo:e.target.value}));},type:\"email\"})]}),/*#__PURE__*/_jsx(\"div\",{className:formInfo.uniqueEmail?\" d-none \":'d-block m-2 font-weight-bold warning-red',children:\"\\xA1Ya hay un usuario con este correo!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-phone\"})})}),/*#__PURE__*/_jsxs(\"select\",{className:\"custom-select\",style:{maxWidth:\"120px\"},value:formInfo.extension,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{extension:e.target.value}));},children:[/*#__PURE__*/_jsx(\"option\",{children:\"+57 1\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 2\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 3\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 4\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 5\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 6\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 7\"}),/*#__PURE__*/_jsx(\"option\",{children:\"+57 8\"})]}),/*#__PURE__*/_jsx(\"input\",{required:true,name:\"phone\",className:\"form-control\",placeholder:\"N\\xFAmero de Tel\\xE9fono\",value:formInfo.telefono,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{telefono:e.target.value}));},type:\"text\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-building\"})})}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",required:true,value:formInfo.tipoUsuario,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{tipoUsuario:e.target.value}));},children:[/*#__PURE__*/_jsx(\"option\",{children:\"Seleccione el tipo de usuario\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Fundaci\\xF3n\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Persona Natural\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-lock\"})})}),/*#__PURE__*/_jsx(\"input\",{required:true,name:\"password\",className:\"form-control\",placeholder:\"Create password\",value:formInfo.password,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{password:e.target.value}));},type:\"password\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:formInfo.matchingPasswords?\"form-group input-group\":'form-group input-group  not-matching-passwords',children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-lock\"})})}),/*#__PURE__*/_jsx(\"input\",{required:true,className:formInfo.matchingPasswords?\"form-control\":'form-control no-box-shadow',placeholder:\"Repeat password\",value:formInfo.confirmationPassword,onChange:function onChange(e){setFormInfo(_objectSpread(_objectSpread({},formInfo),{confirmationPassword:e.target.value}));},type:\"password\"})]}),/*#__PURE__*/_jsx(\"div\",{className:formInfo.matchingPasswords?\"d-none\":'d-block m-2 font-weight-bold warning-red',children:\"\\xA1Las contrase\\xF1as no coinciden!\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\",children:\"Registrame\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-center\",children:[\"Ya tienes una cuenta?\",/*#__PURE__*/_jsx(Link,{to:\"/login\",id:\"IniciarSesionLink\",children:\" Inicia sesion \"})]})]})]})})});};export default Register;","map":{"version":3,"sources":["C:/Users/User/Desktop/prueba despliegue/entrega3-web/front/src/components/auth/Register.js"],"names":["useState","HashLink","Link","useHistory","React","Register","props","setUser","user","nombre","apellido","correo","extension","telefono","tipoUsuario","password","confirmationPassword","matchingPasswords","uniqueEmail","formInfo","setFormInfo","history","onSubmit","e","preventDefault","console","log","verifyExistence","existence","register","mail","fetch","json","email","body","apellidos","fundacion","clave","headers","method","JSON","stringify","localStorage","setItem","push","maxWidth","target","value"],"mappings":"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","sourcesContent":["import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport '../styles/auth.css'\r\nimport { useState } from \"react\";\r\nimport { HashLink as Link } from 'react-router-hash-link';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport React from 'react';\r\n\r\nconst Register = (props) => {\r\n\r\n  const setUser = props.user;\r\n\r\n  const [formInfo, setFormInfo] = useState({\r\n    nombre: '',\r\n    apellido: '',\r\n    correo: '',\r\n    extension: '+57 1',\r\n    telefono: '',\r\n    tipoUsuario: '',\r\n    password: '',\r\n    confirmationPassword: '',\r\n    matchingPasswords: true,\r\n    uniqueEmail: true,\r\n  })\r\n  const history = useHistory();\r\n\r\n  async function onSubmit(e) {\r\n    e.preventDefault();\r\n    if (formInfo.password !== formInfo.confirmationPassword) {\r\n      // Warning message \r\n      setFormInfo({ ...formInfo, ...{ matchingPasswords: false } })\r\n    }\r\n    else {\r\n      setFormInfo({ ...formInfo, ...{ matchingPasswords: true } })\r\n      console.log('Seteado a True');\r\n      const existence = await verifyExistence(formInfo.correo);\r\n      if (existence) {\r\n        // Warning\r\n        setFormInfo({ ...formInfo, ...{ uniqueEmail: false } })\r\n      }\r\n      else {\r\n        // Login\r\n        setFormInfo({ ...formInfo, ...{ uniqueEmail: true } })\r\n        register()\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  async function verifyExistence(mail) {\r\n    try {\r\n      let user = await (await fetch(`/api/users/${mail}`)).json()\r\n      return user.email ? true : false;\r\n\r\n    } catch (error) {\r\n      return false\r\n\r\n    }\r\n  }\r\n\r\n  async function register() {\r\n    const body = {\r\n      nombre: formInfo.nombre,\r\n      apellidos: formInfo.apellido,\r\n      email: formInfo.correo,\r\n      telefono: `${formInfo.extension} ${formInfo.telefono}`,\r\n      fundacion: formInfo.tipoUsuario === 'Fundación'? true: false,\r\n      clave: formInfo.password\r\n    }\r\n    const headers =  {'Content-Type': 'application/json'}\r\n    let user = await (await fetch('/api/users', {\r\n      method: 'POST',\r\n      headers: headers,\r\n      body: JSON.stringify(body)\r\n    })).json()\r\n\r\n    localStorage.setItem('user', JSON.stringify(user))\r\n    setUser(user)\r\n    history.push('/')\r\n    \r\n  }\r\n\r\n  return (\r\n    <section id=\"register\">\r\n      <div className=\"card bg-light\" id=\"registerdiv\">\r\n        <article className=\"card-body mx-auto\" style={{ maxWidth: \"400px\" }}>\r\n          <h4 className=\"card-title mt-3 text-center\">Crea tu cuenta</h4>\r\n          <p className=\"text-center\">y empieza a donar!</p>\r\n\r\n          <form id=\"form-registro\" onSubmit={onSubmit}>\r\n            <div className=\"form-group input-group\">\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-user\"></i>\r\n                </span>\r\n              </div>\r\n              <input\r\n                name=\"name\"\r\n                className=\"form-control\"\r\n                placeholder=\"Nombre\"\r\n                value={formInfo.nombre}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ nombre: e.target.value } })\r\n                }}\r\n                type=\"text\"\r\n                required\r\n              />\r\n              <input\r\n                name=\"lastname\"\r\n                className=\"form-control\"\r\n                placeholder=\"Apellido\"\r\n                value={formInfo.apellido}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ apellido: e.target.value } })\r\n                }}\r\n                type=\"text\"\r\n                required\r\n              />\r\n            </div>\r\n            <div className=\"form-group input-group\">\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-envelope\"></i>\r\n                </span>\r\n              </div>\r\n              <input\r\n                name=\"email\"\r\n                className=\"form-control\"\r\n                placeholder=\"Correo Electrónico\"\r\n                value={formInfo.correo}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ correo: e.target.value } })\r\n                }}\r\n                type=\"email\"\r\n              />\r\n            </div>\r\n            <div\r\n              className={formInfo.uniqueEmail ?\r\n                \" d-none \" : 'd-block m-2 font-weight-bold warning-red'}\r\n            >\r\n              ¡Ya hay un usuario con este correo!\r\n              </div>\r\n            <div className=\"form-group input-group\">\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-phone\"></i>\r\n                </span>\r\n              </div>\r\n              <select className=\"custom-select\"\r\n                style={{ maxWidth: \"120px\" }}\r\n                value={formInfo.extension}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ extension: e.target.value } })\r\n                }}\r\n              >\r\n                <option >+57 1</option>\r\n                <option >+57 2</option>\r\n                <option >+57 3</option>\r\n                <option >+57 4</option>\r\n                <option >+57 5</option>\r\n                <option >+57 6</option>\r\n                <option >+57 7</option>\r\n                <option >+57 8</option>\r\n              </select>\r\n              <input\r\n                required\r\n                name=\"phone\"\r\n                className=\"form-control\"\r\n                placeholder=\"Número de Teléfono\"\r\n                value={formInfo.telefono}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ telefono: e.target.value } })\r\n                }}\r\n                type=\"text\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group input-group\">\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-building\"></i>\r\n                </span>\r\n              </div>\r\n              <select className=\"form-control\"\r\n                required\r\n                value={formInfo.tipoUsuario}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ tipoUsuario: e.target.value } })\r\n                }}\r\n              >\r\n                <option>Seleccione el tipo de usuario</option>\r\n                <option>Fundación</option>\r\n                <option>Persona Natural</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"form-group input-group\">\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-lock\"></i>\r\n                </span>\r\n              </div>\r\n              <input\r\n                required\r\n                name=\"password\"\r\n                className=\"form-control\"\r\n                placeholder=\"Create password\"\r\n                value={formInfo.password}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ password: e.target.value } })\r\n                }}\r\n                type=\"password\"\r\n              />\r\n            </div>\r\n            <div className={formInfo.matchingPasswords ?\r\n              \"form-group input-group\" : 'form-group input-group  not-matching-passwords'}\r\n            >\r\n              <div className=\"input-group-prepend\">\r\n                <span className=\"input-group-text\">\r\n                  <i className=\"fa fa-lock\"></i>\r\n                </span>\r\n              </div>\r\n              <input\r\n                required\r\n                className={formInfo.matchingPasswords ?\r\n                  \"form-control\" : 'form-control no-box-shadow'}\r\n                placeholder=\"Repeat password\"\r\n                value={formInfo.confirmationPassword}\r\n                onChange={(e) => {\r\n                  setFormInfo({ ...formInfo, ...{ confirmationPassword: e.target.value } })\r\n                }}\r\n                type=\"password\"\r\n              />\r\n            </div>\r\n            <div\r\n              className={formInfo.matchingPasswords ?\r\n                \"d-none\" : 'd-block m-2 font-weight-bold warning-red'}\r\n            >\r\n              ¡Las contraseñas no coinciden!\r\n              </div>\r\n            <div className=\"form-group\">\r\n              <button type=\"submit\" className=\"btn btn-primary btn-block\">\r\n                Registrame\r\n              </button>\r\n            </div>\r\n            <p className=\"text-center\">\r\n              Ya tienes una cuenta?\r\n              <Link to='/login' id='IniciarSesionLink'> Inicia sesion </Link>\r\n            </p>\r\n          </form>\r\n        </article>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}